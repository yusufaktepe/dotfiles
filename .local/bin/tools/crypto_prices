#!/usr/bin/env bash

Cur="${1:-BTC|ETH|LINK|DOT|XMR|LTC|USDT}"
Fiat="${2:-TRY|USDT}"
Api=https://api.binance.com/api/v1/ticker/price

shopt -s nocasematch extglob

while read -ra Rate; do
	if [[ ${Rate[*]} =~ ^($Cur)($Fiat).*$ ]]; then
		Coin=${Rate[0]}
		Price=${Rate[1]}
		Price=${Price/%+(0)}
		Rates+=("$(printf '%-8s = %s\n' "$Coin" "${Price/%.}")")
	fi
done < <(curl -s $Api | jq -r '.[] | (.symbol + " " + .price)')

printf '%s\n' "${Rates[@]}" | sort

