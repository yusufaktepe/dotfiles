#!/bin/sh

AW=$(xdotool getactivewindow)
AW_CLASS=$(xprop -id "$AW" | awk -F'"' '/WM_CLASS/{print $4}')

if pgrep -x "cantata" > /dev/null; then
	if [ "$AW_CLASS" = "cantata" ]; then
		i3-msg "workspace back_and_forth" >/dev/null
	else
		i3-msg '[class="cantata"] focus' >/dev/null
	fi
else
	if ! pgrep -x "mpd" > /dev/null; then
		mpd && sleep 1 && cantata
		wait "$(pidof cantata)"
		pkill -TERM mpd
	else
		cantata
	fi
fi

