#!/bin/bash

BG_Default=$XDG_DATA_HOME/backgrounds/wall.png
BG_WS[6]=$HOME/Pictures/Wallpapers/wallhaven-x62rll_1920x1080.png
BG_WS[10]=$HOME/Pictures/Wallpapers/wallhaven-0p6odp_1920x1080.png

setbg() {
	# hsetroot -fill "$@"
	xwallpaper --stretch "$@"
}

trap 'setbg "$BG_Default"' EXIT

while read -r WS; do
	read -r WS_Curr WS_Old <<< "$(jq -r 'select(.change=="focus") | "\(.current.num) \(.old.num)"' <<< "$WS")"

	if [ -n "${BG_WS[$WS_Curr]}" ]; then
		setbg "${BG_WS[$WS_Curr]}"
	else
		[ -n "${BG_WS[$WS_Old]}" ] && setbg "$BG_Default"
	fi

done < <(i3-msg -t subscribe -m '[ "workspace" ]')

