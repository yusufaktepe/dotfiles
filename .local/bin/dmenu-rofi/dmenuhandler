#!/bin/sh

opts="\
copy url
mpv
mpv (loop)
queue download
queue youtube-dl
queue youtube-dl (audio)
browser
sxiv
w3m
"
case "$(printf '%s' "$opts" | dmenu -i -p "Open link with what program?")" in
	"copy url")
		echo "$1" | xclip -selection clipboard ;;
	mpv)
		ym "$1" >/dev/null 2>&1 & ;;
	"mpv (loop)")
		ym --loop "$1" >/dev/null 2>&1 & ;;
	"queue download")
		tsp curl -LO "$1" >/dev/null 2>&1 ;;
	"queue youtube-dl")
		tsp youtube-dl --write-metadata -ic "$1" >/dev/null 2>&1 ;;
	"queue youtube-dl (audio)")
		tsp youtube-dl --add-metadata -xic -f bestaudio/best "$1" >/dev/null 2>&1 ;;
	browser)
		setsid "$BROWSER" "$1" >/dev/null 2>&1 & ;;
	sxiv)
		tmp=/tmp/$(basename "$1")
		curl -sL "$1" > "$tmp" && setsid sxiv -a "$tmp" >/dev/null 2>&1 &
		wait; rm "$tmp" ;;
	w3m)
		w3m "$1" 2>/dev/null ;;
esac
